#!/usr/bin/env zsh

local output=''
local tmux_path=~/.oroshi/config/tmux
local is_active=$1
local tab_index=$2
local tab_name=$3
local tab_flags=$4
local session_name=$5
local tab_icon=''


local session_type="$($tmux_path/helper-get-session-type $session_name)"
local session_color="$($tmux_path/helper-get-session-color $session_type)"

# Add ⮀ if active
if [[ $is_active == 1 ]]; then
  output="#[fg=colour235,bg=$session_color]⮀"
fi

# Add few icons for some specific folders
[[ $tab_name == 'blog' ]]     && tab_icon="  "
[[ $tab_name == 'books' ]]    && tab_icon="  "
[[ $tab_name == 'comics' ]]   && tab_icon="  "
[[ $tab_name == 'dropbox' ]]  && tab_icon="  "
[[ $tab_name == 'movies' ]]   && tab_icon="  "
[[ $tab_name == 'music' ]]    && tab_icon="  "
[[ $tab_name == 'oroshi' ]]   && tab_icon="  "
[[ $tab_name == 'roleplay' ]] && tab_icon="  "
[[ $tab_name == 'twitter' ]]  && tab_icon="  "
[[ $tab_name == 'videos' ]]   && tab_icon="  "

# Add index and name
output="${output}$tab_index:$tab_name $tab_icon"

# Add zoomed icon flag if one of the panels is zoomed
if [[ $tab_flags == *Z* ]]; then
  output="${output} "
fi

# Add final coloring
output="$output#[fg=$session_color,bg=colour235]"

# Add ⮁ or ⮀ depending if active
if [[ $is_active == 1 ]]; then
  output="$output⮀"
else
  output="$output ⮁"
fi

echo $output
