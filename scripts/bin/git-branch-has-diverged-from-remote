#!/usr/bin/env zsh
# Check if the current branch has diverged from the remote and won't be merged

local remoteMergeBase=$(git merge-base @{0} @{upstream} 2>/dev/null)
local remoteHead=$(git rev-parse @{upstream} 2>/dev/null)
local localHead=$(git rev-parse @{0} 2>/dev/null)

# Merge base is different from both local and remote, this won't be merged
if [[ "$remoteMergeBase" != "$remoteHead" && "$remoteMergeBase" != "$localHead" ]]; then
  exit 0
fi
exit 1
